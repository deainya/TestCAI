# Запрос на обслуживание - Streamlit приложение

Мобильное веб-приложение для создания запросов на обслуживание с интеграцией LLM через n8n.

## Функциональность

- ✅ Валидация email пользователя
- ✅ Чат-интерфейс для сбора информации о проблеме
- ✅ Интеграция с LLM через n8n webhook
- ✅ Сбор обязательных данных: тип оборудования, номер устройства, описание, дата
- ✅ Опциональное прикрепление фото
- ✅ Формирование итогового запроса с подтверждением
- ✅ Обработка ошибок и уведомления
- ✅ Мобильная адаптация

## Деплой на Streamlit Community Cloud

### 1. Подготовка репозитория

1. Загрузите файлы в GitHub репозиторий:
   - `app.py` - основное приложение
   - `requirements.txt` - зависимости
   - `n8n_setup.md` - инструкции по настройке n8n

### 2. Настройка n8n

1. Создайте n8n workflow с webhook
2. Настройте LLM интеграцию (OpenAI, Claude, etc.)
3. Получите URL webhook

### 3. Деплой в Streamlit

1. Перейдите на [share.streamlit.io](https://share.streamlit.io)
2. Подключите GitHub репозиторий
3. Укажите:
   - **Main file path:** `app.py`
   - **App URL:** выберите уникальный URL
4. Добавьте секрет:
   - **Key:** `N8N_WEBHOOK_URL`
   - **Value:** URL вашего n8n webhook

### 4. Настройка переменных окружения

В Streamlit Community Cloud добавьте секрет:

```
N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook/your-webhook-id
```

## Локальный запуск

```bash
# Установка зависимостей
pip install -r requirements.txt

# Запуск приложения
streamlit run app.py
```

## Структура приложения

### Основные компоненты

- **Валидация email** - проверка корректности email перед началом работы
- **Чат-интерфейс** - мобильно-адаптированный чат для общения с ассистентом
- **Сбор данных** - автоматическое извлечение информации о проблеме
- **Формирование запроса** - создание итогового запроса на обслуживание
- **Подтверждение** - получение согласия пользователя перед отправкой

### Данные о проблеме

Приложение собирает следующие данные:
- **Тип оборудования** (обязательно)
- **Номер устройства** (обязательно) 
- **Описание проблемы** (обязательно)
- **Дата инцидента** (обязательно)
- **Фото проблемы** (опционально)

## Интеграция с n8n

Приложение отправляет POST запросы в n8n с:
- Сообщением пользователя
- Историей чата
- Текущими данными о проблеме

n8n обрабатывает запросы через LLM и возвращает:
- Ответ ассистента
- Обновленные данные о проблеме

Подробные инструкции по настройке n8n см. в файле `n8n_setup.md`.

## Обработка ошибок

Приложение обрабатывает:
- Таймауты запросов к n8n
- Ошибки подключения
- Некорректные ответы сервера
- Проблемы с валидацией данных

## Мобильная адаптация

Приложение оптимизировано для мобильных устройств:
- Адаптивный дизайн
- Увеличенные элементы управления
- Оптимизированная типографика
- Удобная навигация

## Технические требования

- Python 3.8+
- Streamlit 1.28+
- requests 2.31+
- Доступ к n8n webhook
