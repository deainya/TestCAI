# Запрос на обслуживание

Приложение для создания запросов на обслуживание с чат-интерфейсом и интеграцией с n8n для обработки LLM запросов.

## Функциональность

- ✅ Валидация email пользователя
- ✅ Чат-интерфейс с мобильной версией
- ✅ Интеграция с n8n через webhook
- ✅ Сбор данных о проблеме через диалог
- ✅ Формирование итогового запроса с подтверждением
- ✅ Обработка ошибок и уведомления

## Деплой на Streamlit Community Cloud

1. Загрузите код в GitHub репозиторий
2. Перейдите на [Streamlit Community Cloud](https://share.streamlit.io/)
3. Нажмите "New app"
4. Выберите ваш репозиторий
5. Укажите путь к файлу: `app.py`
6. Добавьте переменную окружения:
   - **N8N_WEBHOOK_URL**: URL вашего n8n webhook

## Структура данных

### Входящие данные для n8n:
```json
{
  "message": "Сообщение пользователя",
  "chat_history": [
    {
      "content": "Текст сообщения",
      "is_user": true/false
    }
  ],
  "problem_data": {
    "equipment_type": "Тип оборудования",
    "device_number": "Номер устройства", 
    "description": "Описание проблемы",
    "incident_date": "Дата инцидента",
    "photo_url": "URL фото"
  }
}
```

### Ожидаемый ответ от n8n:
```json
{
  "response": "Ответ ассистента пользователю",
  "problem_data": {
    "equipment_type": "Обновленные данные",
    "device_number": "Обновленные данные",
    "description": "Обновленные данные", 
    "incident_date": "Обновленные данные",
    "photo_url": "Обновленные данные"
  }
}
```

## Локальный запуск

```bash
pip install -r requirements.txt
streamlit run app.py
```

## Переменные окружения

- `N8N_WEBHOOK_URL` - URL webhook для интеграции с n8n
